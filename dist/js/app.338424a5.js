(function(){"use strict";var t={3909:function(t,e,o){var i=o(9242),n=o(3396),s=o.p+"img/loading.09ef96bd.svg";const a=(0,n._)("img",{src:s,style:{width:"60vw"}},null,-1);function l(t,e){const o=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(n.n4,null,{default:(0,n.w5)((()=>[(0,n.Wm)(o)])),fallback:(0,n.w5)((()=>[a])),error:(0,n.w5)((()=>[(0,n.Uk)(" Error ")])),_:1})}var r=o(89);const u={},c=(0,r.Z)(u,[["render",l]]);var p=c,h=o(2483),d=o.p+"img/quistroll.9f78cee2.png";const w=t=>((0,n.dD)("data-v-9d786aa2"),t=t(),(0,n.Cn)(),t),g={class:"home"},m=w((()=>(0,n._)("div",{class:"title-container"},[(0,n._)("img",{src:d,class:"logo-img"})],-1)));function f(t,e,o,i,s,a){const l=(0,n.up)("FullScreen"),r=(0,n.up)("el-icon"),u=(0,n.up)("qrcode-stream");return(0,n.wg)(),(0,n.iD)("div",g,[m,(0,n.Wm)(r,{class:"lock-on",color:"#8d8d8d"},{default:(0,n.w5)((()=>[(0,n.Wm)(l)])),_:1}),(0,n.Wm)(u,{style:{height:"75vh",width:"100vw"},onDecode:a.onDecode},null,8,["onDecode"])])}o(7658);var y=o(3684),v=o(2748),k={name:"HomeView",components:{QrcodeStream:y.QrcodeStream,FullScreen:v.ITT},methods:{onDecode(t){this.$router.push({path:"/map",query:{id:t}})}}};const _=(0,r.Z)(k,[["render",f],["__scopeId","data-v-9d786aa2"]]);var b=_,C=o(7139),z=o.p+"img/start-flag.c06217b4.svg",W=o.p+"img/goal-flag.bdbb26f8.svg",T=o.p+"img/marker.16dffbd0.svg",O=o.p+"img/hint-flag.6bcab539.svg";const P=(0,n._)("span",{class:"quiz-title"},"Where is this place?",-1),q={key:1},S=(0,n._)("div",null,"No Image",-1),x={key:0},j={key:1},D=(0,n._)("div",null,"No Image",-1),H={key:0},U={key:1},Q=(0,n._)("span",null,[(0,n._)("img",{src:z,width:"20",height:"20",style:{"vertical-align":"middle"}}),(0,n.Uk)(" : Start")],-1),I=(0,n._)("span",null,[(0,n._)("img",{src:W,width:"20",height:"20",style:{"vertical-align":"middle"}}),(0,n.Uk)(" : Goal")],-1),V={key:0,src:z,width:"40",height:"40"},$={key:1,src:W,width:"40",height:"40"},M=(0,n._)("img",{src:T,width:"20",height:"20"},null,-1),E={key:0},N=(0,n._)("img",{src:O,width:"40",height:"40"},null,-1),A=(0,n._)("h3",{class:"hint-title hint-font"},"1: Photos Uploaded by Google Map User",-1),G={class:"hint-font hint-info"},K=(0,n._)("h3",{class:"hint-title hint-font"},"2:Google Map User Review",-1),R={class:"hint-font hint-info"},F={key:1},Y={class:"hint-font"},B=(0,n._)("h3",{class:"hint-title hint-font"},"3:Near Spot on Google Map",-1),Z={class:"hint-font hint-info"},J={key:2,class:"hint-font"},L=(0,n._)("img",{src:O,width:"20",height:"20",style:{"vertical-align":"middle"}},null,-1),X={style:{height:"30vh"}},tt={class:"spot-desc"},et={class:"spot-desc"},ot={class:"dialog-footer"},it=(0,n._)("br",null,null,-1);function nt(t,e,o,i,s,a){const l=(0,n.up)("el-page-header"),r=(0,n.up)("el-image"),u=(0,n.up)("Picture"),c=(0,n.up)("el-icon"),p=(0,n.up)("el-aside"),h=(0,n.up)("el-progress"),d=(0,n.up)("el-main"),w=(0,n.up)("el-container"),g=(0,n.up)("el-card"),m=(0,n.up)("CustomControl"),f=(0,n.up)("Aim"),y=(0,n.up)("el-button"),v=(0,n.up)("Opportunity"),k=(0,n.up)("Marker"),_=(0,n.up)("CustomMarker"),b=(0,n.up)("Circle"),z=(0,n.up)("Polyline"),W=(0,n.up)("GoogleMap"),T=(0,n.up)("Warning"),O=(0,n.up)("el-carousel-item"),nt=(0,n.up)("el-carousel"),st=(0,n.up)("el-divider"),at=(0,n.up)("Close"),lt=(0,n.up)("v-overlay"),rt=(0,n.up)("el-dialog"),ut=(0,n.up)("vue-qrcode");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l,{onBack:e[0]||(e[0]=t=>a.onback()),class:"quiz-header"},{content:(0,n.w5)((()=>[P])),_:1}),(0,n.Wm)(g,{class:"quiz-card"},{default:(0,n.w5)((()=>[i.nowQuiz>=1&&i.nowQuiz<=i.quizTotal?((0,n.wg)(),(0,n.j4)(w,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{width:"100px"},{default:(0,n.w5)((()=>[i.next.quizImage?((0,n.wg)(),(0,n.j4)(r,{key:0,class:"quiz-image",style:{width:"100%",height:"100%"},src:i.next.quizImage,"preview-src-list":[i.next.quizImage],fit:"cover"},null,8,["src","preview-src-list"])):((0,n.wg)(),(0,n.iD)("div",q,[(0,n.Wm)(c,{size:30},{default:(0,n.w5)((()=>[(0,n.Wm)(u)])),_:1}),S]))])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,{percentage:i.nowQuiz/i.quizTotal*100,format:t=>`${i.nowQuiz} of ${i.quizTotal}`},null,8,["percentage","format"]),i.next.quiz?((0,n.wg)(),(0,n.iD)("span",x,(0,C.zw)(i.next.quiz),1)):((0,n.wg)(),(0,n.iD)("span",j,"Please find the location from the image."))])),_:1})])),_:1})):((0,n.wg)(),(0,n.j4)(w,{key:1},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{width:"100px"},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(c,{size:30},{default:(0,n.w5)((()=>[(0,n.Wm)(u)])),_:1}),D])])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[0===i.nowQuiz?((0,n.wg)(),(0,n.iD)("span",H,"First, please go to the start.")):((0,n.wg)(),(0,n.iD)("span",U,"It' s almost there! Please go to the goal."))])),_:1})])),_:1}))])),_:1}),(0,n.Wm)(W,{class:"map-area","api-key":i.apiKey,language:"en",mapTypeId:"roadmap",center:i.center,zoom:14,clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,streetViewControl:!1},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{position:"TOP_CENTER"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"icon-desc"},{default:(0,n.w5)((()=>[Q,I])),_:1})])),_:1}),(0,n.Wm)(m,{position:"TOP_LEFT"},{default:(0,n.w5)((()=>[(0,n._)("button",{onClick:e[1]||(e[1]=t=>a.aim()),class:"custom-ctrl"},[(0,n.Wm)(c,{class:"aim-btn"},{default:(0,n.w5)((()=>[(0,n.Wm)(f)])),_:1})])])),_:1}),(0,n.Wm)(m,{position:"BOTTOM_CENTER"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{type:"primary",class:"hand-btn",onClick:e[2]||(e[2]=e=>t.showConfirm=!0),style:{width:"calc(100vw - 200px)"},disabled:i.nowQuiz>i.quizTotal+1},{default:(0,n.w5)((()=>[(0,n.Uk)(" Submit Your Place ")])),_:1},8,["disabled"])])),_:1}),(0,n.Wm)(m,{position:"TOP_RIGHT"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{circle:"",color:"#FFDE03",class:"hand-btn",style:{width:"50px"},onClick:e[3]||(e[3]=e=>t.showHint=!0)},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{size:20,color:"#4c4c4c"},{default:(0,n.w5)((()=>[(0,n.Wm)(v)])),_:1})])),_:1})])),_:1}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.spots,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{key:e},["midpoint"===t.type?((0,n.wg)(),(0,n.j4)(k,{key:0,options:a.spotOption(t),onClick:e=>a.spotInfo(t)},null,8,["options","onClick"])):((0,n.wg)(),(0,n.j4)(_,{key:1,options:a.spotOption(t)},{default:(0,n.w5)((()=>["start"===t.type?((0,n.wg)(),(0,n.iD)("img",V)):((0,n.wg)(),(0,n.iD)("img",$))])),_:2},1032,["options"]))])))),128)),(0,n.Wm)(b,{options:{center:i.userPos,clickable:!1,radius:i.gpsAccuracy,fillColor:"#78a9ff",fillOpacity:.3,strokeOpacity:0}},null,8,["options"]),(0,n.Wm)(_,{options:{position:i.userPos}},{default:(0,n.w5)((()=>[M])),_:1},8,["options"]),i.wrongCount>=3?((0,n.wg)(),(0,n.iD)("span",E,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.next.hints.nearSpot,((t,e)=>((0,n.wg)(),(0,n.j4)(_,{key:e,options:{position:t}},{default:(0,n.w5)((()=>[N])),_:2},1032,["options"])))),128))])):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.route,((t,e)=>((0,n.wg)(),(0,n.j4)(z,{key:`route-${e}`,options:{path:t,geodesic:!0,clickable:!1,strokeColor:"#4285F4",strokeOpacity:1}},null,8,["options"])))),128))])),_:1},8,["api-key","center"]),(0,n.Wm)(lt,{modelValue:t.showHint,"onUpdate:modelValue":e[5]||(e[5]=e=>t.showHint=e),class:"hint-overlay"},{default:(0,n.w5)((()=>[A,(0,n._)("p",G,[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T)])),_:1}),(0,n.Uk)(" This hint will appear after one submition of the wrong place. ")]),i.wrongCount>=1?((0,n.wg)(),(0,n.j4)(nt,{key:0,class:"hint-image",arrow:"always",autoplay:!1,height:"20vh",style:{width:"90vw"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.next.hints.images,((t,e)=>((0,n.wg)(),(0,n.j4)(O,{key:e},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{src:`data:image/jpeg;charset=utf-8;base64,${t}`,fit:"contain",style:{width:"100%",height:"100%"}},null,8,["src"])])),_:2},1024)))),128))])),_:1})):(0,n.kq)("",!0),K,(0,n._)("p",R,[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T)])),_:1}),(0,n.Uk)(" This hint will appear after two submition of the wrong place. ")]),i.wrongCount>=2?((0,n.wg)(),(0,n.iD)("span",F,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.next.hints.reviews,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{key:e,style:{width:"95%"}},[0!==e?((0,n.wg)(),(0,n.j4)(st,{key:0})):(0,n.kq)("",!0),(0,n._)("p",Y,(0,C.zw)(t),1)])))),128))])):(0,n.kq)("",!0),B,(0,n._)("p",Z,[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(T)])),_:1}),(0,n.Uk)(" This hint will appear after three submition of the wrong place. ")]),i.wrongCount>=3?((0,n.wg)(),(0,n.iD)("p",J,[(0,n.Uk)(" Near spot is displayed as: "),L])):(0,n.kq)("",!0),(0,n.Wm)(y,{size:"large",class:"hint-close",onClick:e[4]||(e[4]=e=>t.showHint=!1)},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{style:{"margin-right":"5px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(at)])),_:1}),(0,n.Uk)(" Close Hints ")])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(lt,{modelValue:t.showSpotInfo,"onUpdate:modelValue":e[6]||(e[6]=e=>t.showSpotInfo=e),onClick:e[7]||(e[7]=e=>t.showSpotInfo=!1)},{default:(0,n.w5)((()=>[(0,n._)("p",X,[(0,n.Wm)(r,{src:`data:image/jpeg;charset=utf-8;base64,${t.showedSpot.image}`,fit:"contain",class:"spot-image"},null,8,["src"])]),(0,n._)("h1",tt,(0,C.zw)(t.showedSpot.name),1),(0,n._)("p",et,(0,C.zw)(t.showedSpot.description),1)])),_:1},8,["modelValue"]),(0,n.Wm)(rt,{modelValue:t.showConfirm,"onUpdate:modelValue":e[10]||(e[10]=e=>t.showConfirm=e),title:"Submit Your Place",width:"80vw"},{footer:(0,n.w5)((()=>[(0,n._)("span",ot,[(0,n.Wm)(y,{onClick:e[8]||(e[8]=e=>t.showConfirm=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("Cancel")])),_:1}),(0,n.Wm)(y,{type:"primary",onClick:e[9]||(e[9]=t=>a.checkArrived())},{default:(0,n.w5)((()=>[(0,n.Uk)(" Arrived ")])),_:1})])])),default:(0,n.w5)((()=>[(0,n.Uk)(" Have you arrived at the destination? ")])),_:1},8,["modelValue"]),(0,n.Wm)(rt,{class:"congrat",modelValue:i.showCongrat,"onUpdate:modelValue":e[11]||(e[11]=t=>i.showCongrat=t),title:"Congratulations!",width:"80vw"},{default:(0,n.w5)((()=>[(0,n.Uk)(" This is proof that you reached the goal. "),it,(0,n.Uk)(" It can be used as a coupon for local area. "),(0,n.Wm)(ut,{value:a.qrBase64,options:{width:200}},null,8,["value"])])),_:1},8,["modelValue"])],64)}o(2801);var st=o(7178),at=o(3430),lt=o(8721),rt=o(4870),ut=o(6924),ct=o(8541),pt=o(4775),ht={name:"HomeView",components:{GoogleMap:at.b6,CustomControl:at.br,Marker:at.Jx,CustomMarker:at.Uo,Circle:at.Cd,Polyline:at.aH,Opportunity:v.cRF,Aim:v.hdx,Picture:v.tap,Close:v.x8P,Warning:v.v3j,VOverlay:lt.yc},data:()=>({showHint:!1,showSpotInfo:!1,showedSpot:null,showConfirm:!1}),methods:{aim(){this.center=this.userPos},spotOption(t){const e={};return e.position=t.position,"midpoint"!==t.type&&(e.offsetX=10,e.anchorPoint="BOTTOM_CENTER"),e},spotInfo(t){this.showedSpot=t,this.showSpotInfo=!0},checkArrived(){this.showConfirm=!1;const t=this.checkPlace();this.arrivedMsg(t),setTimeout((async()=>{const e=pt.kN.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});await this.arrivedProcess(t),e.close()}),1e3)},checkPlace(){const t={latitude:this.userPos.lat,longitude:this.userPos.lng};let e={latitude:this.next.position.lat,longitude:this.next.position.lng};if(0===this.nowQuiz){const t=this.spots.find((t=>"start"===t.type));e={latitude:t.position.lat,longitude:t.position.lng}}else if(this.nowQuiz>this.quizTotal){const t=this.spots.find((t=>"goal"===t.type));e={latitude:t.position.lat,longitude:t.position.lng}}const o=(0,ut.getDistance)(t,e);return o<=150+this.gpsAccuracy},arrivedMsg(t){t?(0,st.z8)({message:"Arrived",type:"success"}):st.z8.error("Not Arrived")},async arrivedProcess(t){if(t){if(this.wrongCount=0,this.nowQuiz>=1&&this.nowQuiz<=this.quizTotal&&this.spots.push({type:"midpoint",position:this.next.position,name:this.next.name,image:this.next.image,description:this.next.description}),this.nowQuiz>=1&&this.nowQuiz<this.quizTotal&&await this.getNext(!1),this.nowQuiz>=this.quizTotal+1&&(this.showCongrat=!0),this.nowQuiz>=1&&this.nowQuiz<=this.quizTotal+1){const t=this.routeRaw[this.nowQuiz-1];this.route.push(t)}this.nowQuiz++,this.cookieSync()}else this.nowQuiz>=1&&this.nowQuiz<=this.quizTotal&&(this.wrongCount++,this.cookieSync())},cookieSync(){const t=this.$route.query.id;this.cookies.set(`${t}_now`,this.nowQuiz),this.cookies.set(`${t}_wrong`,this.wrongCount)},onback(){this.$router.push("/")}},computed:{qrBase64(){const t=this.$route.query.id;return window.btoa(JSON.stringify({mapID:t,status:"goal"}))}},async setup(){const t=(0,rt.iH)({lat:35.684129649804404,lng:139.75510159163784}),e=(0,rt.iH)({lat:35.684129649804404,lng:139.75510159163784}),o=(0,rt.iH)(0),i=t=>{e.value={lat:t.latitude,lng:t.longitude},o.value=t.accuracy};navigator.geolocation.watchPosition((t=>{i(t.coords)}),(t=>{console.log(`GPS Error. Code: ${t.code}`)}));const n={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_GOOGLE_MAP_KEY;(0,ct.T)({expireTimes:"7d"});const{cookies:s}=(0,ct.fP)(),a=(0,h.yj)(),l=a.query.id,r=(0,rt.iH)(0),u=(0,rt.iH)(0);r.value=s.isKey(`${l}_now`)?s.get(`${l}_now`):0,u.value=s.isKey(`${l}_wrong`)?s.get(`${l}_wrong`):0;const c=(0,rt.iH)([]),p=(0,rt.iH)({}),d=(0,rt.iH)(0),w=(0,rt.iH)([]);let g=[];const m=async t=>{const e=t?r.value-1:r.value,o=await fetch(`/api/next/${l}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({now:e})}).then((t=>t.json()));p.value=o.next};await Promise.all([fetch(`/api/init/${l}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({now:r.value})}).then((t=>t.json())).then((e=>{c.value=e.spots,d.value=e.total;const o=e.spots.find((t=>"start"===t.type));t.value=o.position})),fetch(`/api/route/${l}`).then((t=>t.json())).then((t=>{g=t.route;let e=r.value-1;e<0&&(e=0),r.value>g.length&&(e=g.length),w.value=g.slice(0,e)})),m(!0)]);const f=(0,rt.iH)(!1);return f.value=r.value>d.value+1,{center:t,userPos:e,gpsAccuracy:o,apiKey:n,spots:c,next:p,quizTotal:d,route:w,cookies:s,nowQuiz:r,wrongCount:u,getNext:m,routeRaw:g,showCongrat:f}}};const dt=(0,r.Z)(ht,[["render",nt]]);var wt=dt;const gt=[{path:"/",name:"home",component:b},{path:"/map",name:"map",component:wt}],mt=(0,h.p7)({history:(0,h.PO)("/"),routes:gt});var ft=mt,yt=o(65),vt=(0,yt.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}}),kt=o(6726),_t=(o(4415),o(3007)),bt=o(5570),Ct=o(2175);const zt=(0,i.ri)(p);zt.use(vt).use(ft),zt.use(kt.Z);const Wt=(0,_t.Rd)({VOverlay:lt.yc,directives:bt});zt.use(Wt),zt.component(Ct.Z.name,Ct.Z),zt.mount("#app")}},e={};function o(i){var n=e[i];if(void 0!==n)return n.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,o),s.exports}o.m=t,function(){var t=[];o.O=function(e,i,n,s){if(!i){var a=1/0;for(c=0;c<t.length;c++){i=t[c][0],n=t[c][1],s=t[c][2];for(var l=!0,r=0;r<i.length;r++)(!1&s||a>=s)&&Object.keys(o.O).every((function(t){return o.O[t](i[r])}))?i.splice(r--,1):(l=!1,s<a&&(a=s));if(l){t.splice(c--,1);var u=n();void 0!==u&&(e=u)}}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[i,n,s]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,s,a=i[0],l=i[1],r=i[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(r)var c=r(o)}for(e&&e(i);u<a.length;u++)s=a[u],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(c)},i=self["webpackChunkquistroll"]=self["webpackChunkquistroll"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(3909)}));i=o.O(i)})();
//# sourceMappingURL=app.338424a5.js.map